<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contador</title>
    <style>
        /* Estilos para el sistema de pestaÃ±as */
        .tab-container {
            max-width: 800px;
            margin: 20px auto;
            font-family: sans-serif;
        }
        .tab-menu {
            display: flex;
            background-color: #2c3e50;
            border-radius: 8px 8px 0 0;
            overflow: hidden;
        }
        .tab-button {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            color: white;
            font-weight: bold;
            flex: 1;
            transition: background 0.3s;
        }
        .tab-button.active {
            background-color: #3498db;
        }
        .tab-content {
            display: none;
            padding: 20px;
            background: #f4f4f9;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 8px 8px;
        }
        .tab-content.active {
            display: block;
        }

        /* --- TUS ESTILOS ORIGINALES (CARTONES) --- */
        .container-cartones { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        #datosInput { width: 100%; height: 150px; margin-bottom: 10px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; resize: vertical; box-sizing: border-box; }
        .button-group-cartones { display: flex; gap: 10px; margin-bottom: 10px; }
        .btn-process { background-color: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; flex: 1; font-size: 16px; }
        .btn-clear { background-color: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; flex: 1; font-size: 16px; }
        .tabla-cartones { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; }
        .tabla-cartones th, .tabla-cartones td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        .tabla-cartones th { background-color: #f2f2f2; }
        .total { margin-top: 10px; font-weight: bold; color: #333; }

        /* --- TUS ESTILOS ORIGINALES (FACTURAS) --- */
        .container-facturas { background-color: white; padding: 25px; border-radius: 10px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 100%; max-width: 450px; margin: auto; }
        .facturas-h2 { text-align: center; color: #2c3e50; margin-top: 0; }
        #dataInput { width: 100%; height: 120px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; font-family: monospace; }
        .btn-group-facturas { display: flex; gap: 10px; margin-top: 15px; flex-direction: column; }
        .btn-calc { background-color: #3498db; color: white; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 15px; }
        .btn-copy { background-color: #27ae60; color: white; display: none; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 15px; }
        .tabla-facturas { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .tabla-facturas th, .tabla-facturas td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
        .tabla-facturas th { background-color: #f8f9fa; color: #7f8c8d; text-transform: uppercase; font-size: 12px; }
        .total-row { background-color: #ebf5fb; color: #2980b9; font-weight: bold; }
        #msg { text-align: center; color: #27ae60; font-size: 13px; margin-top: 10px; height: 20px; }
    </style>
</head>
<body>

<div class="tab-container">
    <div class="tab-menu">
        <button class="tab-button active" onclick="openTab(event, 'tabCartones')">ðŸ“¦ Contador de Cartones</button>
        <button class="tab-button" onclick="openTab(event, 'tabFacturas')">ðŸ§¾ Contador de Facturas</button>
    </div>

    <div id="tabCartones" class="tab-content active">
        <div class="container-cartones">
            <h2>Contador de Cartones</h2>
            <p>Pega aquÃ­ la columna de PACKAGE_DESCR:</p>
            <textarea id="datosInput" placeholder="Pega los datos aquÃ­..."></textarea>
            
            <div class="button-group-cartones">
                <button class="btn-process" onclick="contarCartones()">Contar y Procesar</button>
                <button class="btn-clear" onclick="limpiarCampos()">Limpiar Datos</button>
            </div>

            <div id="resultadoArea" style="display:none;">
                <p class="total" id="totalLineas"></p>
                <table id="tablaResultados" class="tabla-cartones">
                    <thead>
                        <tr>
                            <th>Tipo de cartÃ³n</th>
                            <th>Cantidad</th>
                        </tr>
                    </thead>
                    <tbody id="cuerpoTabla"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="tabFacturas" class="tab-content">
        <div class="container-facturas">
            <h2 class="facturas-h2">ðŸ§¾ Conteo de Facturas</h2>
            <label style="font-size: 14px; font-weight: bold;">SERVICE_CENTRE:</label>
            <textarea id="dataInput" placeholder="Pegue la columna aquÃ­..."></textarea>
            
            <div class="btn-group-facturas">
                <button class="btn-calc" onclick="procesar()">Calcular Cantidades</button>
                <button id="copyBtn" class="btn-copy" onclick="copiarTabla()">ðŸ“‹ Copiar Tabla</button>
            </div>
            
            <div id="msg"></div>

            <div id="resultSection" style="display:none;">
                <table id="miTabla" class="tabla-facturas">
                    <thead>
                        <tr>
                            <th>Tipo de Despacho</th>
                            <th style="text-align: right;">Cantidad</th>
                        </tr>
                    </thead>
                    <tbody id="tablaBody"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    // LÃ³gica para cambiar de pantallas
    function openTab(evt, tabName) {
        var i, tabContent, tabButtons;
        tabContent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabContent.length; i++) {
            tabContent[i].style.display = "none";
        }
        tabButtons = document.getElementsByClassName("tab-button");
        for (i = 0; i < tabButtons.length; i++) {
            tabButtons[i].className = tabButtons[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }

    // --- TU LÃ“GICA ORIGINAL (CARTONES) ---
    function contarCartones() {
        const input = document.getElementById('datosInput').value;
        const lineas = input.split(/\r?\n/);
        const conteo = {};
        let totalValidos = 0;

        lineas.forEach(linea => {
            let texto = linea.trim();
            if (texto !== "" && texto.toUpperCase() !== "PACKAGE_DESCR") {
                conteo[texto] = (conteo[texto] || 0) + 1;
                totalValidos++;
            }
        });

        if (totalValidos === 0) return;

        const cuerpoTabla = document.getElementById('cuerpoTabla');
        cuerpoTabla.innerHTML = "";
        const resultadosOrdenados = Object.entries(conteo).sort((a, b) => b[1] - a[1]);
        resultadosOrdenados.forEach(([nombre, cantidad]) => {
            let fila = `<tr><td>${nombre}</td><td>${cantidad}</td></tr>`;
            cuerpoTabla.innerHTML += fila;
        });

        document.getElementById('totalLineas').innerText = "Total de registros procesados: " + totalValidos;
        document.getElementById('resultadoArea').style.display = "block";
    }

    function limpiarCampos() {
        document.getElementById('datosInput').value = "";
        document.getElementById('resultadoArea').style.display = "none";
        document.getElementById('cuerpoTabla').innerHTML = "";
        document.getElementById('totalLineas').innerText = "";
    }

    // --- TU LÃ“GICA ORIGINAL (FACTURAS) ---
    function procesar() {
        const text = document.getElementById('dataInput').value;
        const lines = text.split('\n')
            .map(l => l.trim())
            .filter(l => l !== '' && l.toUpperCase() !== 'SERVICE_CENTRE');
        
        let c = { cs: 0, dom: 0, tra: 0, pex: 0, enl: 0, otr: 0 };

        lines.forEach(n => {
            if (n.startsWith('12')) c.cs++;
            else if (n.startsWith('99')) c.dom++;
            else if (n.startsWith('4')) c.tra++;
            else if (n.startsWith('5') || n.startsWith('8') || n.startsWith('9')) c.pex++;
            else if (n.startsWith('6') || n.startsWith('7')) c.enl++;
            else c.otr++;
        });

        const rows = [
            ["Centro Servicio", c.cs],
            ["Domicilio", c.dom],
            ["Transporte", c.tra],
            ["Punto Express", c.pex],
            ["Enlaces", c.enl]
        ];
        if(c.otr > 0) rows.push(["Otros/Sin Clasificar", c.otr]);

        const tbody = document.getElementById('tablaBody');
        tbody.innerHTML = rows.map(r => `<tr><td>${r[0]}</td><td>${r[1]}</td></tr>`).join('') + 
                          `<tr class="total-row"><td>TOTAL</td><td>${lines.length}</td></tr>`;

        document.getElementById('resultSection').style.display = 'block';
        document.getElementById('copyBtn').style.display = 'block';
        document.getElementById('msg').innerText = "";
    }

    function copiarTabla() {
        const table = document.getElementById('miTabla');
        let range, sel;
        if (document.createRange && window.getSelection) {
            range = document.createRange();
            sel = window.getSelection();
            sel.removeAllRanges();
            try {
                range.selectNodeContents(table);
                sel.addRange(range);
            } catch (e) {
                range.selectNode(table);
                sel.addRange(range);
            }
            document.execCommand('copy');
            sel.removeAllRanges();
            const msg = document.getElementById('msg');
            msg.innerText = "Â¡Tabla copiada! Lista para pegar";
            setTimeout(() => msg.innerText = "", 3000);
        }
    }
</script>

</body>
</html>